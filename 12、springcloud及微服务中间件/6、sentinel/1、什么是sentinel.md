## 什么是sentinel

随着微服务的流行，服务和服务之间的稳定性变得越来越重要。Sentinel 是面向分布式、多语言异构化服务架构的流量治理组件，主要以流量为切入点，从流量路由、流量控制、流量整形、熔断降级、系统自适应过载保护、热点流量防护等多个维度来帮助开发者保障微服务的稳定性。



#### 什么叫熔断降级

我们的微服务调用链很长且环环相扣，比如A服务请求B服务，B服务请求C服务，C服务请求D服务，如果在C服务请求D服务的时候，卡住了（卡住的原因有很多），是不是整条链路都在等待，那么是不是用户的请求就被hold住了。如果个把的请求还可以，如果请求过多，是不是会导致前部的所有服务都在等待，然后会导致整条线的崩溃。使用熔断降级可以可以对D资源进行限制，让请求快速失败，避免影响到其它资源。

Sentinel 对熔断降级采取了两种手段:

- 通过并发线程数进行限制

  Sentinel 通过限制资源并发线程的数量，来减少不稳定资源对其它资源的影响。这样不但没有线程切换的损耗，也不需要您预先分配线程池的大小。当某个资源出现不稳定的情况下，例如响应时间变长，对资源的直接影响就是会造成线程数的逐步堆积。当线程数在特定资源上堆积到一定的数量之后，对该资源的新请求就会被拒绝。堆积的线程完成任务后才开始继续接收请求。

- 通过响应时间对资源进行降级

  Sentinel 还可以通过响应时间来快速降级不稳定的资源。当依赖的资源出现响应时间过长后，所有对该资源的访问都会被直接拒绝，直到过了指定的时间窗口之后才重新恢复。



#### 什么叫流量控制

在我们的服务器中，任意时间到来的请求往往是随机不可控的，而系统的处理能力是有限的。我们需要根据系统的处理能力对流量进行控制。

流量控制有以下几个角度:

- 资源的调用关系，例如资源的调用链路，资源和资源之间的关系；
- 运行指标，例如 QPS、线程池、系统负载等；
- 控制的效果，例如直接限流、冷启动、排队等。