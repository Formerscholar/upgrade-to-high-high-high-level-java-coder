## 为什么要使用消息队列



#### 1、流量削峰

我们有一个订单服务，每分钟能处理1万的订单量。这个处理能力在正常生产下没有问题，但是，如果咱们的系统搞活动，在活动期间订单量大增，每分钟到了100万的订单量了，可想而知，这时候订单服务肯定会出问题。这个时候如果我们在订单服务前加个消息队列做缓冲，到消息队列订单有多少收多少，后面的订单服务慢慢处理即可！就达到了把大流量进行削峰的作用。



#### 2、应用解耦

我们有一套系统，包含订单、库存、物流、支付等服务。用户创建订单后，后续的库存、物流、支付等服务都耦合在一起，那么其中一个服务挂了用户都不能完成下单。如果我们把应用解耦，在应用与应用之间加消息队列的服务，那么即便是应用挂了，数据也会缓冲在消息队列中，等挂了的应用恢复正常再从消息队列把数据拿到继续做处理就行。



#### 3、异步处理

比如在订单、库存服务中，用户下单减扣库存，在同步情况下，整个流程是一条线完成的，下单扣库存，如果库存服务网络波动的情况下，会出现下单卡顿。而如果我们在订单和库存服务中间加个消息队列，用户下单之后，把消息投递到消息队列，随即直接返回不用等待后面库存服务是否成功。