(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-01fb5305","chunk-7491e9c6","chunk-2d20e7ac"],{"03af":function(e,t,a){"use strict";a("78cf")},2936:function(e,t,a){"use strict";a("966f0")},"78cf":function(e,t,a){},"7a62":function(e,t,a){},"966f0":function(e,t,a){},"9b16":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"orderList"},[a("div",{staticClass:"orderBox",staticStyle:{width:"70%"}},[a("titleTab",{attrs:{title:"查询条件"}}),a("el-form",{ref:"queryForm",staticClass:"searchBox",attrs:{model:e.queryForm,size:"small","label-width":"160px"}},[a("el-form-item",{attrs:{label:"车辆类型：",prop:"carType"}},[a("el-select",{staticStyle:{width:"220px"},attrs:{placeholder:"请选择车辆类型",clearable:""},model:{value:e.queryForm.carType,callback:function(t){e.$set(e.queryForm,"carType",t)},expression:"queryForm.carType"}},e._l(e.carList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.code}})})),1)],1),a("el-form-item",{attrs:{label:"车牌号：",prop:"carNumber"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请输入车牌号",clearable:""},model:{value:e.queryForm.carNumber,callback:function(t){e.$set(e.queryForm,"carNumber",t)},expression:"queryForm.carNumber"}})],1),a("el-form-item",{attrs:{label:"入场时间：",prop:"entryTime"}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择入场时间"},model:{value:e.queryForm.entryTime,callback:function(t){e.$set(e.queryForm,"entryTime",t)},expression:"queryForm.entryTime"}})],1),a("el-form-item",{attrs:{label:"出场时间：",prop:"exitTime"}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择出场时间"},model:{value:e.queryForm.exitTime,callback:function(t){e.$set(e.queryForm,"exitTime",t)},expression:"queryForm.exitTime"}})],1)],1),a("div",{staticClass:"subBox"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("查询")]),a("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v("重置")])],1),a("titleTab",{attrs:{title:"订单记录"}}),a("div",{staticClass:"importDiv"},[a("el-button",{staticClass:"addOrder",attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:e.addOrder}},[e._v("新增")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.handleExport}},[e._v("导出所有")]),a("el-button",{staticClass:"importButton",attrs:{type:"primary",size:"mini"},on:{click:e.handleImport}},[e._v("导入记录")])],1),a("div",{staticClass:"tableBox"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData,"row-class-name":e.tableRowClassName},on:{"row-click":e.getPhoto}},[a("el-table-column",{attrs:{label:"序号",align:"center",type:"index",width:"50"}}),a("el-table-column",{attrs:{label:"车牌","min-width":"180",align:"center",prop:"carNumber"}}),a("el-table-column",{attrs:{label:"车类型","min-width":"160",align:"center",prop:"carTypeName"}}),a("el-table-column",{attrs:{label:"入场时间","min-width":"260",align:"center",prop:"entryTime"}}),a("el-table-column",{attrs:{label:"出场时间","min-width":"260",align:"center",prop:"exitTime"}}),a("el-table-column",{attrs:{label:"停留时长","min-width":"260",align:"center",prop:"durationTime"}}),a("el-table-column",{attrs:{label:"收费总额(元)","min-width":"260",align:"center",prop:"parkingFee"}}),a("el-table-column",{attrs:{label:"备注","min-width":"160",align:"center",prop:"remark"}}),a("el-table-column",{attrs:{width:"120",fixed:"right",label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"colorHollowBtnCyan",attrs:{size:"mini",type:"text"},on:{click:function(a){return e.getDetail(t.row)}}},[e._v("查看")]),a("el-button",{staticClass:"colorHollowBtnRed",attrs:{size:"mini",type:"text"},on:{click:function(a){return e.deleteOrder(t.row)}}},[e._v("删除")])]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.pageInfo.total>0,expression:"pageInfo.total > 0"}],attrs:{total:e.pageInfo.total,page:e.pageInfo.pageNum,limit:e.pageInfo.pageSize},on:{"update:page":function(t){return e.$set(e.pageInfo,"pageNum",t)},"update:limit":function(t){return e.$set(e.pageInfo,"pageSize",t)},pagination:e.getList}})],1)],1),a("div",{staticClass:"orderBox",staticStyle:{width:"30%","margin-left":"20px"}},[a("titleTab",{attrs:{title:"图片显示"}}),a("div",{staticClass:"photoBox"},[a("div",{staticClass:"carLicence"},[e._m(0),a("div",{staticClass:"photoImg"},[e.carImgFrom?a("img",{attrs:{src:e.carImgFrom,alt:""}}):e._e()])]),a("div",{staticClass:"carImg"},[e._m(1),a("div",{staticClass:"photoImg"},[e.carImgTo?a("img",{attrs:{src:e.carImgTo,alt:""}}):e._e()])])])],1),a("el-dialog",{staticClass:"addDialog",attrs:{title:"补录订单",visible:e.addShow,width:"683px","append-to-body":""},on:{"update:visible":function(t){e.addShow=t}}},[a("div",{staticClass:"addCon"},[a("el-form",{ref:"addForm",staticClass:"addBox",attrs:{rules:e.addRules,model:e.addForm,size:"small","label-width":"120px"}},[a("el-form-item",{attrs:{label:"车牌号：",prop:"carNumber"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请输入车牌号",clearable:""},model:{value:e.addForm.carNumber,callback:function(t){e.$set(e.addForm,"carNumber",t)},expression:"addForm.carNumber"}})],1),a("el-form-item",{attrs:{label:"入场时间：",prop:"entryTime",required:""}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择入场时间"},model:{value:e.addForm.entryTime,callback:function(t){e.$set(e.addForm,"entryTime",t)},expression:"addForm.entryTime"}})],1),a("el-form-item",{attrs:{label:"出场时间：",prop:"exitTime",required:""}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择出场时间"},model:{value:e.addForm.exitTime,callback:function(t){e.$set(e.addForm,"exitTime",t)},expression:"addForm.exitTime"}})],1),a("el-form-item",{attrs:{label:"备注：",prop:"remark"}},[a("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请输入备注",clearable:""},model:{value:e.addForm.remark,callback:function(t){e.$set(e.addForm,"remark",t)},expression:"addForm.remark"}})],1),a("el-form-item",[a("el-button",{staticClass:"confirmButton",attrs:{type:"primary",size:"mini"},on:{click:e.addConfirm}},[e._v("确定")]),a("el-button",{staticClass:"cancleButton",attrs:{size:"mini"},on:{click:function(t){e.addShow=!1}}},[e._v("取消")])],1)],1)],1)]),a("el-dialog",{attrs:{title:e.upload.title,visible:e.upload.open,width:"400px","append-to-body":""},on:{"update:visible":function(t){return e.$set(e.upload,"open",t)}}},[a("el-upload",{ref:"upload",attrs:{limit:1,accept:".xlsx, .xls",headers:e.upload.headers,action:e.upload.url+"?updateSupport="+e.upload.updateSupport,disabled:e.upload.isUploading,"on-progress":e.handleFileUploadProgress,"on-success":e.handleFileSuccess,"auto-upload":!1,drag:""}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),a("div",{staticClass:"el-upload__tip text-center",attrs:{slot:"tip"},slot:"tip"},[a("span",[e._v("仅允许导入xls、xlsx格式文件。")])])]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitFileForm}},[e._v("确 定")]),a("el-button",{on:{click:function(t){e.upload.open=!1}}},[e._v("取 消")])],1)],1),a("el-dialog",{staticClass:"detailDialog",attrs:{title:"订单详情",visible:e.detailShow,width:"862px","append-to-body":""},on:{"update:visible":function(t){e.detailShow=t}}},[a("div",{staticClass:"detailCon"},[a("div",{staticClass:"conTit"},[a("titleTab",{attrs:{title:"车辆信息"}})],1),a("div",{staticClass:"conTable mt15"},[a("el-table",{attrs:{data:e.detail.fieldInfo}},[a("el-table-column",{attrs:{label:"区域","min-width":"180",align:"center",prop:"parkFieldName"}}),a("el-table-column",{attrs:{label:"车牌","min-width":"160",align:"center",prop:"carNumber"}}),a("el-table-column",{attrs:{label:"车类型","min-width":"160",align:"center",prop:"carTypeName"}}),a("el-table-column",{attrs:{label:"入场通道","min-width":"220",align:"center",prop:"entryPassageName"}}),a("el-table-column",{attrs:{label:"入场时间","min-width":"220",align:"center",prop:"entryTime"}}),a("el-table-column",{attrs:{label:"出场通道","min-width":"220",align:"center",prop:"exitPassageName"}}),a("el-table-column",{attrs:{label:"出场时间","min-width":"220",align:"center",prop:"exitTime"}}),a("el-table-column",{attrs:{label:"停留总时长","min-width":"220",align:"center",prop:"stopTime"}})],1)],1),a("div",{staticClass:"conTit mt15"},[a("titleTab",{attrs:{title:"付费信息"}})],1),a("div",{staticClass:"conTable mt15"},[a("el-table",{attrs:{data:e.detail.parkingOrderInfo}},[a("el-table-column",{attrs:{label:"订单编号","min-width":"200",align:"center",prop:"orderNo"}}),a("el-table-column",{attrs:{label:"应付金额(元)","min-width":"160",align:"center",prop:"payAmount"}}),a("el-table-column",{attrs:{label:"实付金额(元)","min-width":"160",align:"center",prop:"paidAmount"}}),a("el-table-column",{attrs:{label:"支付通道","min-width":"120",align:"center",prop:"passageNo"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.passageNo?t.row.passageNo:"预支付")+" ")]}}])}),a("el-table-column",{attrs:{label:"支付方式","min-width":"120",align:"center",prop:"payMethod"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.showDictLabel(e.dict.type.pay_method,t.row.payMethod))+" ")]}}])}),a("el-table-column",{attrs:{label:"付款时间","min-width":"180",align:"center",prop:"payTime"}}),a("el-table-column",{attrs:{label:"备注","min-width":"120",align:"center",prop:"remark"}})],1)],1)])])],1)},i=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"photoTit"},[a("span",[e._v("车辆进场照")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"photoTit"},[a("span",[e._v("车辆出场照")])])}],l=a("3600"),n=a("46fc"),o=a("1c61"),s=(a("6b3f"),a("2fcd"),a("f721"),a("9dc0")),c=a("5f87"),d=a("b019"),u={name:"orderList",components:{titleTab:s["default"]},props:{},dicts:["pay_method"],data:function(){var e=this,t=function(t,a,r){a?(e.addForm.entryTime&&e.$refs.addForm.validateField("exitTime"),r()):r(new Error("请选择入场时间"))},a=function(t,a,r){a?e.addForm.entryTime?new Date(e.addForm.entryTime).getTime()>=new Date(a).getTime()?r(new Error("出场时间必须大于入场时间！")):r():r(new Error("请选择入场时间！")):r(new Error("请选择出场时间"))};return{labelPosition:"right",queryForm:{entryTime:"",exitTime:"",carType:"",carNumber:""},tableData:[],pageInfo:{total:0,pageSize:10,pageNum:1},carList:this.$store.getters.carList,aisleList:this.$store.getters.carAisleList,areaList:this.$store.getters.carAreaList,loading:!1,upload:{open:!1,title:"",isUploading:!1,updateSupport:!0,headers:{Authorization:"Bearer "+Object(c["b"])()},url:"/prod-api/parking/parksettlementrecords/import"},carImgFrom:"",carImgTo:"",nowClickId:"",detailShow:!1,detail:{},addShow:!1,addForm:{carNumber:"",entryTime:"",exitTime:"",remark:""},addRules:{carNumber:[{required:!0,message:"请输入车牌号",trigger:"blur"}],entryTime:[{validator:t,trigger:"blur"}],exitTime:[{validator:a,trigger:"blur"}]}}},computed:{},watch:{},methods:{showDictLabel:function(e,t){var a;return(null===(a=e.find((function(e){return e.value==t})))||void 0===a?void 0:a.label)||"--"},getList:function(){var e=this;return Object(o["a"])(Object(l["a"])().mark((function t(){var a,r;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,a=Object(n["a"])({pageSize:e.pageInfo.pageSize,pageNum:e.pageInfo.pageNum},e.queryForm),t.next=4,Object(d["getOrderList"])(a);case 4:r=t.sent,200==r.code&&(e.loading=!1,e.tableData=r.rows,e.pageInfo.total=r.total);case 6:case"end":return t.stop()}}),t)})))()},getPhoto:function(e,t,a){this.nowClickId=e.id,this.carImgFrom=e.carImgUrlFrom,this.carImgTo=e.carImgUrlTo},tableRowClassName:function(e){var t=e.row;e.rowIndex;return t.id===this.nowClickId?"highlight-row":""},handleQuery:function(){this.pageInfo.pageNum=1,this.getList()},resetQuery:function(){this.resetForm("queryForm"),this.handleQuery()},handleExport:function(){this.download("parking/parksettlementrecords/export",Object(n["a"])({},this.queryForm),"order_".concat((new Date).getTime(),".xlsx"))},handleImport:function(){this.upload.title="用户导入",this.upload.open=!0},handleFileUploadProgress:function(e,t,a){this.upload.isUploading=!0},handleFileSuccess:function(e,t,a){this.upload.open=!1,this.upload.isUploading=!1,this.$refs.upload.clearFiles(),this.$alert("<div style='overflow: auto;overflow-x: hidden;max-height: 70vh;padding: 10px 20px 0;'>"+e.msg+"</div>","导入结果",{dangerouslyUseHTMLString:!0}),this.getList()},submitFileForm:function(){this.$refs.upload.submit()},getDetail:function(e){this.detailShow=!0,this.detailOrder(e.id)},detailOrder:function(e){var t=this;return Object(o["a"])(Object(l["a"])().mark((function a(){var r;return Object(l["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(d["getDetailOrder"])(e);case 2:r=a.sent,200==r.code&&(t.detail=r.data);case 4:case"end":return a.stop()}}),a)})))()},addOrder:function(){this.addShow=!0},addConfirm:function(){var e=this;return Object(o["a"])(Object(l["a"])().mark((function t(){return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs["addForm"].validate(function(){var t=Object(o["a"])(Object(l["a"])().mark((function t(a){var r,i;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=8;break}return r=Object(n["a"])({},e.addForm),t.next=4,Object(d["addOrder"])(r);case 4:i=t.sent,200==i.code?(e.addShow=!1,e.getList(),e.$message.success("新增离场订单成功！")):e.$message.error("新增离场订单失败！"),t.next=9;break;case 8:e.$message.error("验证失败！");case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()},deleteOrder:function(e){var t=this;this.$confirm("确定删除这条订单记录？","删除提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(d["deleteOrder"])(e.id).then((function(e){200===e.code&&(t.$message.success("删除订单成功！"),t.getList())})).catch((function(e){t.$message.error(e)}))})).catch((function(){}))}},created:function(){},mounted:function(){this.getList()}},m=u,p=(a("03af"),a("2936"),a("e607")),b=Object(p["a"])(m,r,i,!1,null,"0be9be82",null);t["default"]=b.exports},"9dc0":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"title"},[a("span",{staticClass:"leftSpan"}),a("span",{staticClass:"rightSpan"},[e._v(e._s(e.title))])])},i=[],l={components:{},props:{title:{type:String,default:""}},data:function(){return{}},computed:{},watch:{},methods:{},created:function(){},mounted:function(){}},n=l,o=(a("f2af"),a("e607")),s=Object(o["a"])(n,r,i,!1,null,"4b61fe51",null);t["default"]=s.exports},b019:function(e,t,a){"use strict";a.r(t),a.d(t,"getOrderList",(function(){return i})),a.d(t,"addOrder",(function(){return l})),a.d(t,"deleteOrder",(function(){return n})),a.d(t,"getDetailOrder",(function(){return o}));var r=a("b775");function i(e){return Object(r["a"])({url:"parking/parksettlementrecords/list",method:"get",params:e})}function l(e){return Object(r["a"])({url:"parking/parksettlementrecords/add",method:"post",data:e})}function n(e){return Object(r["a"])({url:"parking/parksettlementrecords/remove/"+e,method:"get"})}function o(e){return Object(r["a"])({url:"parking/parksettlementrecords/info?id="+e,method:"get"})}},f2af:function(e,t,a){"use strict";a("7a62")}}]);