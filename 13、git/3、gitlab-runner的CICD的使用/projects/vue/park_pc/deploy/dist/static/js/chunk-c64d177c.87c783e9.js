(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c64d177c"],{2352:function(e,t,o){"use strict";o.r(t);var a,r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"addCarInfoDialog"},[o("el-dialog",{staticClass:"addCarInfoDialog",attrs:{title:e.title,visible:e.dialogOpen,"close-on-click-modal":!1,width:"800px","append-to-body":""},on:{"update:visible":function(t){e.dialogOpen=t},close:e.cancel}},[o("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[o("titleTab",{style:{margin:"0 0 20px 0 "},attrs:{title:"车牌信息"}}),o("el-row",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"车牌",prop:"carNumber"}},[o("el-input",{attrs:{placeholder:"请输入车牌",maxlength:"50"},model:{value:e.form.carNumber,callback:function(t){e.$set(e.form,"carNumber",t)},expression:"form.carNumber"}})],1)],1),o("el-col",{attrs:{span:12,prop:"carColor"}},[o("el-form-item",{attrs:{label:"车辆颜色"}},[o("el-input",{attrs:{placeholder:"请输入车辆颜色"},model:{value:e.form.carColor,callback:function(t){e.$set(e.form,"carColor",t)},expression:"form.carColor"}})],1)],1),o("el-col",{attrs:{span:24}},[o("el-form-item",{attrs:{label:"备注",prop:"carRemark"}},[o("el-input",{attrs:{type:"textarea",autosize:{minRows:2},placeholder:"请输入备注"},model:{value:e.form.carRemark,callback:function(t){e.$set(e.form,"carRemark",t)},expression:"form.carRemark"}})],1)],1)],1),o("titleTab",{style:{margin:"0 0 20px 0 "},attrs:{title:"车主信息"}}),o("el-row",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"车主姓名",prop:"ownerName"}},[o("el-input",{attrs:{placeholder:"请输入车主姓名"},model:{value:e.form.ownerName,callback:function(t){e.$set(e.form,"ownerName",t)},expression:"form.ownerName"}})],1)],1),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"联系方式",prop:"ownerPhone"}},[o("el-input",{attrs:{placeholder:"请输入联系方式"},model:{value:e.form.ownerPhone,callback:function(t){e.$set(e.form,"ownerPhone",t)},expression:"form.ownerPhone"}})],1)],1),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"身份证号",prop:"ownerCardId"}},[o("el-input",{attrs:{placeholder:"请输入身份证号"},model:{value:e.form.ownerCardId,callback:function(t){e.$set(e.form,"ownerCardId",t)},expression:"form.ownerCardId"}})],1)],1),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"车主地址",prop:"ownerAddress"}},[o("el-input",{attrs:{placeholder:"请输入车主地址"},model:{value:e.form.ownerAddress,callback:function(t){e.$set(e.form,"ownerAddress",t)},expression:"form.ownerAddress"}})],1)],1),o("el-col",{staticClass:"flowPlaceNumber",attrs:{span:12}},[o("el-form-item",{attrs:{label:"流动车位",prop:"flowPlaceNumber"}},[o("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:e.form.flowPlaceNumber,callback:function(t){e.$set(e.form,"flowPlaceNumber",t)},expression:"form.flowPlaceNumber"}})],1)],1),o("el-col",{attrs:{span:24}},[o("el-form-item",{attrs:{label:"有效期",prop:"time"}},[o("el-date-picker",{attrs:{type:"daterange",disabled:e.form.timeLimit,"range-separator":"至","start-placeholder":"开始","end-placeholder":"结束"},model:{value:e.form.time,callback:function(t){e.$set(e.form,"time",t)},expression:"form.time"}}),o("el-checkbox",{staticClass:"timeLimit",on:{change:e.changeTimeLimit},model:{value:e.form.timeLimit,callback:function(t){e.$set(e.form,"timeLimit",t)},expression:"form.timeLimit"}},[e._v(" 永久有效期")])],1)],1),o("el-col",{attrs:{span:24}},[o("el-form-item",{attrs:{label:"备注",prop:"remark"}},[o("el-input",{attrs:{type:"textarea",autosize:{minRows:2},placeholder:"请输入内容"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1)],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),o("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)},l=[],i=o("559a"),n=o("3808"),s=o("d8e1"),c=(a={name:"AddCarInfoDialog",components:{titleTab:n["a"]},props:{title:{type:String,default:""},detail:{type:Object},open:{type:Boolean,default:!1},nowType:{type:Object,default:function(){return{}}}},watch:function(){},data:function(){return{format:"YYYY-MM-DD",dialogOpen:this.open,rules:{carNumber:[{required:!0,message:"车牌不能为空",trigger:"blur"}],ownerName:[{required:!0,message:"车主姓名不能为空",trigger:"blur"}]},form:{carNumber:"",carColor:"",carRemark:"",ownerName:"",ownerPhone:"",ownerCardId:"",ownerAddress:"",flowPlaceNumber:1,time:null,timeLimit:null,remark:""}}},computed:{}},Object(i["a"])(a,"watch",{}),Object(i["a"])(a,"created",(function(){this.detail.id&&this.getformData()})),Object(i["a"])(a,"mounted",(function(){})),Object(i["a"])(a,"methods",{handlefromDate:function(){var e=this.form,t=e.carNumber,o=e.carColor,a=e.carRemark,r=e.ownerName,l=e.ownerPhone,i=e.ownerCardId,n=e.ownerAddress,s=e.flowPlaceNumber,c=e.time,m=e.timeLimit,d=e.remark,p=e.id,u={carNumber:t,carColor:o,carRemark:a,ownerName:r,ownerPhone:l,ownerCardId:i,ownerAddress:n,flowPlaceNumber:s,timeLimit:m?1:0,remark:d},f=this.format;if(c){var h=c[0],w=c[1],b=h?this.$moment(h).format(f):"",g=w?this.$moment(w).format(f):"";u.startTime=b,u.endTime=g}return void 0!=p&&(u.id=p),this.nowType.id&&(u.carCategoryId=this.nowType.id),u},getformData:function(){if(this.detail.id){var e=this.detail,t=e.carNumber,o=e.carColor,a=e.carRemark,r=e.ownerName,l=e.ownerPhone,i=e.ownerCardId,n=e.ownerAddress,s=e.flowPlaceNumber,c=e.endTime,m=e.startTime,d=e.timeLimit,p=e.remark,u=e.id,f=1===+d;if(this.form={carNumber:t,carColor:o,carRemark:a,ownerName:r,ownerPhone:l,ownerCardId:i,ownerAddress:n,flowPlaceNumber:s,timeLimit:f,remark:p},void 0!=u&&(this.form.id=u),c&&m){var h=[m,c];this.form.time=h}}},cancel:function(){this.reset(),this.dialogOpen=!1,this.$emit("cancel",!1)},reset:function(){this.form={carNumber:"",carColor:"",carRemark:"",ownerName:"",ownerPhone:"",ownerCardId:"",ownerAddress:"",flowPlaceNumber:1,time:null,timeLimit:null,remark:""},this.resetForm("form")},submitForm:function(){var e=this;this.$refs["form"].validate((function(t){if(t){var o=e.handlefromDate();void 0!=o.id?Object(s["editRegularCar"])(o).then((function(t){200===+t.code?(e.$modal.msgSuccess("修改成功"),e.$emit("success",!1)):(e.$modal.msgError("修改失败"),e.$emit("cancel",!1))})):Object(s["addRegularCar"])(o).then((function(t){200===+t.code?(e.$modal.msgSuccess("新增成功"),e.$emit("success",!1)):(e.$modal.msgError("新增失败"),e.$emit("success",!1))}))}}))},changeTimeLimit:function(e){var t=this.form.time;if(e)if(t){var o=t[0],a=t[1],r=this.$moment(a).add(100,"years");this.form.time=[o,r],console.log("adela editor",o,a)}else{var l=this.$moment(new Date),i=this.$moment(l).add(100,"years");this.form.time=[l,i]}else if(t){var n=t[0],s=t[1],c=this.$moment(s).subtract(100,"years");this.form.time=[n,c],console.log("adela editor",n,s)}}}),a),m=c,d=(o("dd24"),o("e607")),p=Object(d["a"])(m,r,l,!1,null,"26d40b46",null);t["default"]=p.exports},"28fd":function(e,t,o){"use strict";o("b111")},aca7:function(e,t,o){},b111:function(e,t,o){},ca77:function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.nowType&&e.nowType.id?o("div",{staticClass:"carList"},[o("el-form",{ref:"queryForm",staticClass:"searchBox",attrs:{model:e.queryForm,size:"small","label-width":"120px"}},[o("el-row",{attrs:{gutter:50}},[o("el-col",{staticStyle:{display:"flex","flex-direction":"column","align-items":"end"},attrs:{span:12}},[o("el-form-item",{attrs:{label:"车主姓名",prop:"ownerName"}},[o("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请输入车主姓名",clearable:""},model:{value:e.queryForm.ownerName,callback:function(t){e.$set(e.queryForm,"ownerName",t)},expression:"queryForm.ownerName"}})],1),o("el-form-item",{attrs:{label:"联系方式",prop:"ownerPhone"}},[o("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请输入联系方式",clearable:""},model:{value:e.queryForm.ownerPhone,callback:function(t){e.$set(e.queryForm,"ownerPhone",t)},expression:"queryForm.ownerPhone"}})],1)],1),o("el-col",{staticStyle:{display:"flex","flex-direction":"column","align-items":"start"},attrs:{span:12}},[o("el-form-item",{attrs:{label:"车牌号：",prop:"carNumber"}},[o("el-input",{staticStyle:{width:"220px"},attrs:{placeholder:"请输入车牌号",clearable:""},model:{value:e.queryForm.carNumber,callback:function(t){e.$set(e.queryForm,"carNumber",t)},expression:"queryForm.carNumber"}})],1),o("el-form-item",{attrs:{label:"类型：",prop:"carType"}},[o("el-select",{staticStyle:{width:"220px"},attrs:{placeholder:"类型：",clearable:""},model:{value:e.queryForm.carType,callback:function(t){e.$set(e.queryForm,"carType",t)},expression:"queryForm.carType"}},[o("el-option",{key:"",attrs:{label:"全部",value:""}}),o("el-option",{key:"0",attrs:{label:"线下",value:"0"}}),o("el-option",{key:"1",attrs:{label:"线上",value:"1"}})],1)],1)],1)],1),o("el-form-item",{staticClass:"subBox"},[o("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("查询")]),o("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:e.resetQuery}},[e._v("重置")])],1)],1),o("titleTab",{attrs:{title:"车辆记录"}}),o("div",{staticClass:"importDiv"},[o("el-button",{staticClass:"addBtn",attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:e.addCarInfo}},[e._v("新增")]),o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-download"},on:{click:e.handleExportTemplate}},[e._v("模版")]),o("el-button",{attrs:{type:"primary",icon:"el-icon-download",size:"mini"},on:{click:e.handleExport}},[e._v("导出")]),o("el-button",{staticClass:"importButton",attrs:{type:"primary",icon:"el-icon-upload2",size:"mini"},on:{click:e.handleImport}},[e._v("导入")])],1),o("div",{staticClass:"tableBox"},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData}},[o("el-table-column",{attrs:{label:"序号",align:"center",type:"index",width:"80",fixed:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.$index+(e.pageInfo.pageNum-1)*e.pageInfo.pageSize+1))])]}}],null,!1,3414994957)}),o("el-table-column",{attrs:{label:"车牌号","min-width":"100",prop:"carNumber","show-overflow-tooltip":!0}}),o("el-table-column",{attrs:{label:"车辆颜色","min-width":"100",prop:"carColor","show-overflow-tooltip":!0}}),o("el-table-column",{attrs:{label:"车牌备注","min-width":"200",prop:"carRemark","show-overflow-tooltip":!0}}),o("el-table-column",{attrs:{label:"车主姓名","min-width":"100",prop:"ownerName","show-overflow-tooltip":!0}}),o("el-table-column",{attrs:{label:"身份证号","min-width":"220",prop:"ownerCardId","show-overflow-tooltip":!0}}),o("el-table-column",{attrs:{label:"联系地址","min-width":"260",prop:"ownerAddress","show-overflow-tooltip":!0}}),o("el-table-column",{attrs:{label:"联系电话","min-width":"160",prop:"ownerPhone","show-overflow-tooltip":!0}}),o("el-table-column",{attrs:{label:"流动车位数","min-width":"100",prop:"flowPlaceNumber","show-overflow-tooltip":!0}}),o("el-table-column",{attrs:{label:"有效期开始时间","min-width":"160",prop:"startTime","show-overflow-tooltip":!0}}),o("el-table-column",{attrs:{label:"有效期结束时间","min-width":"160",prop:"endTime","show-overflow-tooltip":!0}}),o("el-table-column",{attrs:{label:"备注",prop:"remark","min-width":"200","show-overflow-tooltip":!0}}),o("el-table-column",{attrs:{width:"120",fixed:"right",label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(o){return e.editRow(t.row)}}},[e._v("编辑")]),o("el-button",{staticClass:"colorHollowBtnRed",attrs:{size:"mini",type:"text"},on:{click:function(o){return e.deleteRow(t.row)}}},[e._v("删除")])]}}],null,!1,1566983259)})],1),o("pagination",{directives:[{name:"show",rawName:"v-show",value:e.pageInfo.total>0,expression:"pageInfo.total > 0"}],attrs:{total:e.pageInfo.total,page:e.pageInfo.pageNum,limit:e.pageInfo.pageSize},on:{"update:page":function(t){return e.$set(e.pageInfo,"pageNum",t)},"update:limit":function(t){return e.$set(e.pageInfo,"pageSize",t)},pagination:e.getList}})],1),o("el-dialog",{attrs:{title:e.upload.title,visible:e.upload.open,width:"400px","append-to-body":""},on:{"update:visible":function(t){return e.$set(e.upload,"open",t)}}},[o("el-upload",{ref:"upload",attrs:{limit:1,accept:".xlsx, .xls",headers:e.upload.headers,action:e.upload.url+"?updateSupport="+e.upload.updateSupport+"&carCategoryId="+e.nowType.id,disabled:e.upload.isUploading,"on-progress":e.handleFileUploadProgress,"on-success":e.handleFileSuccess,"auto-upload":!1,drag:""}},[o("i",{staticClass:"el-icon-upload"}),o("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),o("em",[e._v("点击上传")])]),o("div",{staticClass:"el-upload__tip text-center",attrs:{slot:"tip"},slot:"tip"},[o("span",[e._v("仅允许导入xls、xlsx格式文件。")])])]),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:e.submitFileForm}},[e._v("确 定")]),o("el-button",{on:{click:function(t){e.upload.open=!1}}},[e._v("取 消")])],1)],1),e.openV?o("div",[o("carDialog",{attrs:{open:e.openV,title:e.title,detail:e.detail,nowType:e.nowType},on:{cancel:e.cancelCarInfo,success:e.successCar}})],1):e._e()],1):e._e()},r=[],l=o("3600"),i=o("1c61"),n=o("46fc"),s=o("3808"),c=o("2352"),m=o("5f87"),d=o("d8e1"),p={name:"carList",components:{titleTab:s["a"],carDialog:c["default"]},props:{searchType:{type:Boolean,default:!1},nowType:{type:Object,default:function(){return{}}}},data:function(){return{detail:{},openV:!1,rules:{},queryForm:{ownerName:"",ownerPhone:"",carNumber:"",carType:""},tableData:[],pageInfo:{total:0,pageSize:10,pageNum:1},loading:!1,upload:{open:!1,title:"",isUploading:!1,updateSupport:0,headers:{Authorization:"Bearer "+Object(m["b"])()},url:"/prod-api/parking/regularCar/importData"}}},computed:{},watch:{nowType:{deep:!0,handler:function(e){e&&e.id&&this.handleQuery()}}},created:function(){console.log(11)},mounted:function(){this.getList()},methods:{addCarInfo:function(){this.title="新增车牌信息",this.detail.id=void 0,this.openV=!0},editRow:function(e){this.title="修改车牌信息",this.detail=e,this.openV=!0},deleteRow:function(e){var t=this,o=e.id;this.$modal.confirm("是否确认删除".concat(e.ownerName,"的数据")).then((function(){return Object(d["removeRegularCar"])(o)})).then((function(){t.getList(),t.$modal.msgSuccess("删除成功")})).catch((function(){}))},cancelCarInfo:function(){this.detail={},this.openV=!1},successCar:function(){this.detail={},this.openV=!1,this.getList()},handleParams:function(){this.searchType&&(this.queryForm.ownerName=this.nowType.ownerName,this.queryForm.carNumber=this.nowType.carNumber,this.queryForm.ownerPhone=this.nowType.ownerPhone,this.queryForm.carType=this.nowType.carType);var e=Object(n["a"])(Object(n["a"])({},this.queryForm),{},{pageSize:this.pageInfo.pageSize,pageNum:this.pageInfo.pageNum,carCategoryId:this.nowType.id});return e},getList:function(){var e=this;return Object(i["a"])(Object(l["a"])().mark((function t(){var o,a;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=e.handleParams(),e.loading=!0,t.next=4,Object(d["regularCarList"])(o);case 4:a=t.sent,200===a.code?(e.tableData=a.rows,e.pageInfo.total=a.total,e.loading=!1,e.$emit("closeGlobalSearch",!1)):console.log(1111);case 6:case"end":return t.stop()}}),t)})))()},handleQuery:function(){this.pageInfo.pageNum=1,this.getList()},resetQuery:function(){this.resetForm("queryForm"),this.handleQuery()},handleExportTemplate:function(){this.download("/parking/regularCar/importTemplate",{},"车辆信息模版.xlsx")},handleExport:function(){this.download("/parking/regularCar/export",Object(n["a"])({carCategoryId:this.nowType.id},this.queryForm),"车辆信息_".concat((new Date).getTime(),".xlsx"))},handleImport:function(){this.upload.title="用户导入",this.upload.open=!0},handleFileUploadProgress:function(e,t,o){this.upload.isUploading=!0},handleFileSuccess:function(e,t,o){this.upload.open=!1,this.upload.isUploading=!1,this.$refs.upload.clearFiles(),this.$alert("<div style='overflow: auto;overflow-x: hidden;max-height: 70vh;padding: 10px 20px 0;'>"+e.msg+"</div>","导入结果",{dangerouslyUseHTMLString:!0}),this.getList()},submitFileForm:function(){this.$refs.upload.submit()}}},u=p,f=(o("28fd"),o("e607")),h=Object(f["a"])(u,a,r,!1,null,"6e8693cf",null);t["default"]=h.exports},dd24:function(e,t,o){"use strict";o("aca7")}}]);