(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-62023f8e","chunk-6da20d4c","chunk-2d0e1b24","chunk-2d0c9015"],{"176e":function(e,t,i){"use strict";i.r(t);var o=i("7c13");i.d(t,"getVisitorCodeList",(function(){return o["getVisitorCodeList"]})),i.d(t,"addVisitorCodeItem",(function(){return o["addVisitorCodeItem"]})),i.d(t,"editVisitorCodeItem",(function(){return o["editVisitorCodeItem"]})),i.d(t,"deleteVisitorCodeItem",(function(){return o["deleteVisitorCodeItem"]})),i.d(t,"activateVisitorCodeItem",(function(){return o["activateVisitorCodeItem"]})),i.d(t,"deactivateVisitorCodeItem",(function(){return o["deactivateVisitorCodeItem"]})),i.d(t,"getDetail",(function(){return o["getDetail"]}));var r=i("56fd");i.d(t,"getVisitorMList",(function(){return r["getVisitorMList"]})),i.d(t,"approveVisitorMItems",(function(){return r["approveVisitorMItems"]})),i.d(t,"disApproveVisitorMItems",(function(){return r["disApproveVisitorMItems"]}))},"19bd":function(e,t,i){},3808:function(e,t,i){"use strict";var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"title"},[i("span",{staticClass:"leftSpan"}),i("span",{staticClass:"rightSpan"},[e._v(e._s(e.title))])])},r=[],a={components:{},props:{title:{type:String,default:"标题"}},data:function(){return{}},computed:{},watch:{},methods:{},created:function(){},mounted:function(){}},n=a,s=(i("7e93"),i("e607")),c=Object(s["a"])(n,o,r,!1,null,"7f67c1ca",null);t["a"]=c.exports},"435b":function(e,t,i){"use strict";i.r(t);var o,r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"visitorCodeDialog"},[i("el-dialog",{staticClass:"visitorCodeDialog",attrs:{title:e.title,visible:e.dialogOpen,"close-on-click-modal":!1,width:"980px","append-to-body":""},on:{"update:visible":function(t){e.dialogOpen=t},close:e.cancel}},[i("div",{staticClass:"visitorCodeLc"},[i("titleTab",{attrs:{title:"访客码设置"}}),i("el-form",{ref:"form",staticStyle:{"padding-top":"20px"},attrs:{model:e.form,rules:e.rules,"label-width":"130px"}},[i("el-row",[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"访客码名称：",prop:"codeName"}},[i("el-input",{staticStyle:{width:"350px"},attrs:{disabled:e.dialogIsCheck,placeholder:"请输入访客码名称",maxlength:"50"},model:{value:e.form.codeName,callback:function(t){e.$set(e.form,"codeName",t)},expression:"form.codeName"}})],1)],1),i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"绑定次数：",prop:"codeUseNumber"}},[i("el-input-number",{staticStyle:{width:"350px"},attrs:{"controls-position":"right",min:1,disabled:e.dialogIsCheck,placeholder:"请输入绑定次数",maxlength:"50"},model:{value:e.form.codeUseNumber,callback:function(t){e.$set(e.form,"codeUseNumber",t)},expression:"form.codeUseNumber"}})],1)],1),i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"免费天数：",prop:"codeFreeDay"}},[i("el-input-number",{staticStyle:{width:"350px"},attrs:{"controls-position":"right",min:1,disabled:e.dialogIsCheck,placeholder:"请输入免费天数",maxlength:"50"},model:{value:e.form.codeFreeDay,callback:function(t){e.$set(e.form,"codeFreeDay",t)},expression:"form.codeFreeDay"}}),i("span",[e._v(" 天")])],1)],1),i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"二维码有效期：",prop:"timeRequired"}},[i("el-col",{attrs:{span:24}},[i("el-date-picker",{attrs:{type:"daterange",disabled:e.form.timeLimit||e.dialogIsCheck,"range-separator":"至","start-placeholder":"开始","end-placeholder":"结束"},model:{value:e.form.time,callback:function(t){e.$set(e.form,"time",t)},expression:"form.time"}})],1),i("el-col",{attrs:{span:24}},[i("el-checkbox",{staticClass:"timeLimit",attrs:{disabled:e.dialogIsCheck},on:{change:e.changeTimeLimit},model:{value:e.form.timeLimit,callback:function(t){e.$set(e.form,"timeLimit",t)},expression:"form.timeLimit"}},[e._v(" 永久有效期")])],1)],1)],1),i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"备注：",prop:"remark"}},[i("el-input",{staticStyle:{width:"350px"},attrs:{disabled:e.dialogIsCheck,type:"textarea",autosize:{minRows:2},placeholder:"请输入内容"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1)],1)],1),!e.dialogIsCheck&&e.isShowAddBtn?i("div",{staticClass:"btnc"},[i("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),i("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1):e._e()],1),i("div",{staticClass:"visitorCodeRc"},[i("titleTab",{attrs:{title:"二维码生成"}}),i("div",{staticClass:"codeContent"},[i("div",{staticClass:"codeContentT"},[e._v("二维码")]),i("div",{staticClass:"codeContentC"},[i("canvas",{attrs:{id:"qrCodeUrl"}})])]),e.detail.id||e.allowDownload?i("div",{staticClass:"createCode codeBottom"},[i("el-button",{staticClass:"codeGBtn",on:{click:e.downloadCodeIg}},[e._v("下载二维码")])],1):e._e()],1)])],1)},a=[],n=i("559a"),s=i("3600"),c=i("1c61"),d=i("46fc"),l=(i("6b3f"),i("66d7"),i("3808")),m=i("176e"),u=i("0b59"),f=i.n(u),p=(o={name:"VisitorCodeDialog",components:{titleTab:l["a"]},props:{title:{type:String,default:""},detail:{type:Object},open:{type:Boolean,default:!1},dialogIsCheck:{type:Boolean,default:!1}},watch:function(){},data:function(){var e=this,t=function(t,i,o){var r=e.form,a=r.timeLimit,n=r.time;a||n?o():o(new Error("请选择时间"))};return{allowDownload:!1,format:"YYYY-MM-DD",dialogOpen:this.open,rules:{codeName:[{required:!0,message:"访客码不能为空",trigger:"blur"}],codeUseNumber:[{required:!0,message:"绑定次数不能为空",trigger:"blur"}],codeFreeDay:[{required:!0,message:"免费天数不能为空",trigger:"blur"}],timeRequired:[{required:!0,validator:t,trigger:"blur"}]},form:{codeName:"",codeUseNumber:"",codeFreeDay:"",time:null,timeLimit:null,remark:""},isShowAddBtn:!0}},computed:{}},Object(n["a"])(o,"watch",{}),Object(n["a"])(o,"created",(function(){var e=this;if(this.detail&&this.detail.id){this.getformData();var t=this.detail;this.$nextTick((function(){e.initRQcode(t)}))}else this.$nextTick((function(){e.initGQcode()}))})),Object(n["a"])(o,"mounted",(function(){})),Object(n["a"])(o,"methods",{handlefromDate:function(){var e=this.form,t=e.code,i=e.codeName,o=e.codeUseNumber,r=e.codeFreeDay,a=e.time,n=e.timeLimit,s=e.remark,c=e.id,d={code:t,codeName:i,codeUseNumber:o,codeFreeDay:r,timeLimit:n?1:0,remark:s},l=this.format;if(a){var m=a[0],u=a[1],f=m?this.$moment(m).format(l):"",p=u?this.$moment(u).format(l):"";d.startTime=f,d.endTime=p}return void 0!=c&&(d.id=c),d},getformData:function(){if(this.detail.id){var e=this.detail,t=e.codeName,i=e.codeUseNumber,o=e.codeFreeDay,r=e.endTime,a=e.startTime,n=e.timeLimit,s=e.remark,c=e.id,d=1===+n;if(this.form={codeName:t,codeUseNumber:i,codeFreeDay:o,timeLimit:d,remark:s},void 0!=c&&(this.form.id=c),r&&a){var l=[a,r];this.form.time=l}}},cancel:function(){this.reset(),this.dialogOpen=!1,this.$emit("cancel",!1)},reset:function(){this.form={codeName:"",codeUseNumber:"",codeFreeDay:"",time:null,timeLimit:null,remark:""},this.resetForm("form")},submitForm:function(){var e=this;this.isShowAddBtn=!0;this.$refs["form"].validate((function(t){if(t){var i=e.handlefromDate();void 0!=i.id?Object(m["editVisitorCodeItem"])(i).then((function(t){200===+t.code?(e.$modal.msgSuccess("修改成功"),e.initRQcode(i),e.$emit("success",!1)):601===+t.code?e.$modal.msgError(t.msg):e.$modal.msgError("修改失败")})):Object(m["addVisitorCodeItem"])(i).then((function(t){if(200===+t.code){var o=t.msg;e.initRQcode(Object(d["a"])(Object(d["a"])({},i),{},{code:o})),e.$modal.msgSuccess("新增成功"),e.$emit("success",!1),e.isShowAddBtn=!1}else 601===+t.code?e.$modal.msgError(t.msg):e.$modal.msgError("新增失败")}))}}))},changeTimeLimit:function(e){this.$refs.form.validateField("timeRequired");var t=this.form.time;if(e)if(t){var i=t[0],o=t[1],r=this.$moment(o).add(100,"years");this.form.time=[i,r],console.log("adela editor",i,o)}else{var a=this.$moment(new Date),n=this.$moment(a).add(100,"years");this.form.time=[a,n]}else if(t){var s=t[0],c=t[1],d=this.$moment(c).subtract(100,"years");this.form.time=[s,d]}},downloadCodeIg:function(){var e=document.getElementById("qrCodeUrl"),t=e.toDataURL("image/png"),i=t,o=document.createElement("a"),r=new MouseEvent("click");o.download=this.form.codeName||"访客码",o.href=i,o.dispatchEvent(r)},createQcodeIMG:function(e){var t=arguments;return Object(c["a"])(Object(s["a"])().mark((function i(){var o,r,a,n,c,d,l,m,u,p,h,g,v,b;return Object(s["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return o=t.length>1&&void 0!==t[1]?t[1]:280,r=t.length>2&&void 0!==t[2]?t[2]:"访客二维码",a=t.length>3&&void 0!==t[3]?t[3]:"#000",i.next=5,f.a.toCanvas(document.getElementById("qrCodeUrl"),e,{errorCorrectionLevel:"H",height:o,width:o,color:{dark:a},errorCorrectLevel:"L",rendererOpts:{quality:.8}});case 5:return n=i.sent,c="bold",d=14,l=5,m=o+d+2*l,u=n.getContext("2d"),p=u.getImageData(0,0,o,o),u.fillStyle="#fff",n.setAttribute("height",m),n.style.setProperty("height",m+"px"),u.fillRect(0,0,o,m),u.putImageData(p,0,0),u.font="".concat(c," ").concat(d,"px Arial"),h=u.measureText(r).width,g=o,v=(o-h)/2,b=d/2,u.fillStyle="#fff",u.fillRect(0,o,o,m-2*l),u.fillRect(v-b/2,g-b/2,h+b,d+b),u.textBaseline="top",u.fillStyle="#333",u.fillText(r,v,g),i.abrupt("return",n);case 29:case"end":return i.stop()}}),i)})))()},initGQcode:function(){this.createQcodeIMG("暂无数据",280,"请填写访客码信息","#c2c2c2")},initRQcode:function(e){var t=this;return Object(c["a"])(Object(s["a"])().mark((function i(){var o,r;return Object(s["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return o=e.code?e.code:"",r="http://192.168.2.172:81/appointment/index/0?code=".concat(o),console.log("地址暂时还没换fy那边的现在这样，记录一下",r),i.next=5,t.createQcodeIMG(r,280,e.codeName,"#000");case 5:t.allowDownload=!0;case 6:case"end":return i.stop()}}),i)})))()}}),o),h=p,g=(i("e023"),i("e607")),v=Object(g["a"])(h,r,a,!1,null,"5026018e",null);t["default"]=v.exports},"56fd":function(e,t,i){"use strict";i.r(t),i.d(t,"getVisitorMList",(function(){return n})),i.d(t,"approveVisitorMItems",(function(){return s})),i.d(t,"disApproveVisitorMItems",(function(){return c}));var o=i("b775"),r="/parking/BVisitorApplyManage",a={getVisitorMList:"".concat(r,"/list"),approveVisitorMItems:"".concat(r,"/approve/"),disApproveVisitorMItems:"".concat(r,"/reject")};function n(e){return Object(o["a"])({url:a.getVisitorMList,method:"get",params:e})}function s(e){return Object(o["a"])({url:a.approveVisitorMItems+e,method:"get"})}function c(e){return Object(o["a"])({url:a.disApproveVisitorMItems,method:"get",params:e})}},"7c13":function(e,t,i){"use strict";i.r(t),i.d(t,"getVisitorCodeList",(function(){return n})),i.d(t,"addVisitorCodeItem",(function(){return s})),i.d(t,"editVisitorCodeItem",(function(){return c})),i.d(t,"deleteVisitorCodeItem",(function(){return d})),i.d(t,"activateVisitorCodeItem",(function(){return l})),i.d(t,"deactivateVisitorCodeItem",(function(){return m})),i.d(t,"getDetail",(function(){return u}));var o=i("b775"),r="/parking/BVisitorCodeManage",a={getVisitorCodeList:"".concat(r,"/list"),addVisitorCodeItem:"".concat(r,"/add"),editVisitorCodeItem:"".concat(r,"/edit"),deleteVisitorCodeItem:"".concat(r,"/delete/"),activateVisitorCodeItem:"".concat(r,"/activate/"),deactivateVisitorCodeItem:"".concat(r,"/deactivate/"),getDetail:"".concat(r,"/")};function n(e){return Object(o["a"])({url:a.getVisitorCodeList,method:"get",params:e})}function s(e){return Object(o["a"])({url:a.addVisitorCodeItem,method:"post",data:e})}function c(e){return Object(o["a"])({url:a.editVisitorCodeItem,method:"post",data:e})}function d(e){return Object(o["a"])({url:a.deleteVisitorCodeItem+e,method:"get"})}function l(e){return Object(o["a"])({url:a.activateVisitorCodeItem+e,method:"get"})}function m(e){return Object(o["a"])({url:a.deactivateVisitorCodeItem+e,method:"get"})}function u(e){return Object(o["a"])({url:a.getDetail+e,method:"get"})}},"7e93":function(e,t,i){"use strict";i("19bd")},c628:function(e,t,i){},e023:function(e,t,i){"use strict";i("c628")}}]);